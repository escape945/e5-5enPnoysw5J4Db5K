<!DOCTYPE html><html lang="zh-cn" theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Websocket Shell</title><style>:root{--theme-color:#056dff;--theme-color-active:#0051c3;--text-color:#000;--background-color:#fff;--background-color-html:#f3f3f3;--background-color-span:#e3e3e3;--gutters-color-1:#414141;--tags-shadow:0 -1px 6px 1px rgba(0, 0, 0, 0.316);--status-error:#d32f2f;--status-warn:#fbc02d;--status-succes:#388e3c;--status-waiting:#9e9e9e}:root[theme=dark]{--text-color:#f2f2ff;--background-color-html:#252526;--background-color:#1e1e1e;--background-color-span:#424242;--gutters-color-1:#414141;--tags-shadow:0 -1px 6px 1px #000000;--status-error:#b71c1c;--status-warn:#f57f17;--status-succes:#1b5e20;--status-waiting:#616161}*{padding:0;margin:0;box-sizing:border-box;scrollbar-width:thin}body,html{position:relative;width:100%;height:100%;color:var(--text-color);overflow:hidden;transition:color ease .2s,background-color ease .2s}html{background-color:var(--background-color-html)}body{display:flex;flex-flow:row}#left-box{position:relative;padding:8px;height:100%;width:15.5%;text-align:right}#left-box>*{margin-bottom:7px}.main-area{background-color:var(--background-color);transition:background-color ease .2s;position:relative;height:100%;width:84.5%;display:flex;flex-flow:column}input.s1{font-family:Consolas,'Courier New',monospace;font-size:14px;position:relative;color:var(--text-color);background-color:var(--background-color);padding:6px 8px;border-radius:5px;border:1px solid #797979;transition:color ease .2s,background-color ease .2s,border-color .2s ease 0s,box-shadow 150ms ease 0s}input.s1:active,input.s1:focus,input.s1:hover{border-color:var(--theme-color)}input.s1:focus{box-shadow:var(--background-color) 0 0 0 2px,var(--theme-color) 0 0 0 4px;outline:0}button.s1{font-family:Segoe WPC,Segoe UI,sans-serif;font-size:13px;position:relative;white-space:nowrap;padding:6px;border:0;border-radius:5px;width:auto;color:#f2f2f2;background-color:var(--theme-color);transition:color ease .2s,background-color .2s ease 0s,box-shadow 150ms ease 0s}button.s1:active,button.s1:focus,button.s1:hover{background-color:var(--theme-color-active)}button.s1:focus{box-shadow:var(--background-color) 0 0 0 2px,var(--theme-color) 0 0 0 4px;outline:0}#wsPath{padding:8px;width:100%;display:flex;position:relative;border-left:4px solid var(--status-error);transition:border-left ease .2s}#wsPath[status=connecting]{border-left-color:var(--status-warn)}#wsPath[status=connected]{border-left-color:var(--status-succes)}#wsPath input{width:100%;margin-left:8px}#shellInput{width:100%;height:100%;display:flex;flex-direction:column;position:relative;border-top:1px solid var(--gutters-color-1);transition:border-top ease .2s;overflow:hidden}#shellInput .tags,#shellReturn .tags{position:relative;font-size:0;padding:3px 16px 7px;user-select:none;z-index:1;box-shadow:var(--tags-shadow);transition:box-shadow ease .2s}#shellInput .tags>span,#shellReturn .tags>span{font-family:Segoe WPC,Segoe UI,sans-serif;font-size:13px;font-weight:400;display:inline-block;position:relative;padding:0 2px 2px;margin-right:12px;border-bottom:1px solid var(--theme-color);cursor:pointer}#shellInput .container{height:100%;user-select:none}#shellReturn{width:100%;height:100%;position:relative;display:flex;flex-direction:column;border-top:1px solid var(--gutters-color-1);transition:border-top ease .2s;overflow:hidden}#shellReturn .container{position:relative;padding-right:4px;font-size:0;overflow:auto}#shellReturn .container>div{border-left:4px solid transparent;transition:border-left ease .2s;padding:2px 8px 2px;display:inline-block;position:relative;width:100%;height:auto}#shellReturn .container>div *{font-family:Consolas,'Courier New',monospace;font-weight:400;font-size:14px}#shellReturn .container>div[action=stdout]{border-left:4px solid var(--status-waiting)}#shellReturn .container>div[action=error],#shellReturn .container>div[action=stderr]{border-left:4px solid var(--status-error)}#shellReturn .container>div[action=close]{border-left:4px solid var(--status-warn);margin-bottom:24px}#shellReturn .container>div>span{display:inline-block;position:relative;background-color:var(--background-color-span);transition:background-color ease .2s;border-radius:4px;padding:2px 4px;cursor:pointer;user-select:none;margin-bottom:4px;margin-right:4px}#shellReturn .container>div>pre{position:relative}</style></head><body><div id="left-box"><button class="toggle-theme s1">亮/暗</button><br><button class="full-screen s1">全屏</button><br><button class="run-code s1">运行</button></div><div class="main-area"><div id="wsPath" status=""><button class="s1">连/断</button> <input type="url" class="s1"></div><div id="shellInput"><div class="tags"><span>COMMAND</span></div><div class="container" auto></div></div><div id="shellReturn"><div class="tags"><span>OUTPUT</span> <span class="clear">[CLEAR]</span> <span class="ping">[PING]</span></div><div class="container"></div></div></div></body><link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/editor/editor.main.css"><script>var require={paths:{vs:"https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs"},"vs/nls":{availableLanguages:{"*":"zh-cn"}}}</script><script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/loader.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/editor/editor.main.nls.zh-cn.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/editor/editor.main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/basic-languages/shell/shell.min.js"></script><script>"use strict";let ws=null;document.querySelector("#wsPath button").addEventListener("click",()=>{dis_connect()}),document.querySelector("#wsPath input").addEventListener("keydown",a=>{"Enter"==a.key&&dis_connect()}),document.querySelector("#wsPath input").value=localStorage["Websocket Shell/wsPath/69aec3cd-7dad-4220-94c9-7c3c743d6b63"]?localStorage["Websocket Shell/wsPath/69aec3cd-7dad-4220-94c9-7c3c743d6b63"]:`${location.protocol.replace("http","ws")}//${location.host}/shell`,document.querySelector("#wsPath input").addEventListener("input",()=>{let a=document.querySelector("#wsPath input").value;a?localStorage.setItem("Websocket Shell/wsPath/69aec3cd-7dad-4220-94c9-7c3c743d6b63",a):localStorage.removeItem("Websocket Shell/wsPath/69aec3cd-7dad-4220-94c9-7c3c743d6b63")});function dis_connect(){if("connected"==document.querySelector("#wsPath").getAttribute("status"))ws.close(),document.querySelector("#wsPath").removeAttribute("status");else{document.querySelector("#wsPath").setAttribute("status","connecting");try{var b;ws=new WebSocket(document.querySelector("#wsPath input").value),ws.onopen=()=>{document.querySelector("#wsPath").setAttribute("status","connected"),b=setInterval(()=>{ws.send("[PING]")},2e4)},ws.onclose=c=>{console.log("WebSocket close:",{code:c.code,reason:c.reason,wasClean:c.wasClean}),ws=null,clearInterval(b),document.querySelector("#wsPath").removeAttribute("status")},ws.onerror=a=>{console.log("WebSocket error:",a)},ws.onmessage=e=>{if("[PONG]"!=e.data){console.log(e);let f=decodeURI(e.data);console.log(f);let a=document.querySelector("#shellReturn .container"),b=f.match(/^\[(.*?),(.*?)\]\n((?:.|\n)*?)$/s);console.log(b);let c=`<div action="${b[2]}"><span>PID: ${b[1]}</span><pre><code>${b[3]}</code></pre></div>`;a.innerHTML+=c,a.scrollTop=a.scrollHeight}}}catch{document.querySelector("#wsPath").removeAttribute("status")}}}let shellInputEditor=null;initShellInputEditor("vs-dark");function initShellInputEditor(a){if(shellInputEditor&&shellInputEditor.dispose(),shellInputEditor=monaco.editor.create(document.querySelector("#shellInput .container"),{value:localStorage["Websocket Shell/shellInput/a0460de0-60b0-475d-9874-f98c1e2de686"],language:"shell",acceptSuggestionOnCommitCharacter:!0,acceptSuggestionOnEnter:"on",automaticLayout:!0,scrollBeyondLastLine:!1,theme:a}),shellInputEditor.focus(),localStorage["Websocket Shell/shellInput/a0460de0-60b0-475d-9874-f98c1e2de686/position"]){let a=localStorage["Websocket Shell/shellInput/a0460de0-60b0-475d-9874-f98c1e2de686/position"].split(",");shellInputEditor.setPosition({lineNumber:+a[0],column:+a[1]})}shellInputEditor.onDidChangeModelContent(()=>{shellInputEditor.getValue()?localStorage.setItem("Websocket Shell/shellInput/a0460de0-60b0-475d-9874-f98c1e2de686",shellInputEditor.getValue()):localStorage.removeItem("Websocket Shell/shellInput/a0460de0-60b0-475d-9874-f98c1e2de686")}),shellInputEditor.onDidChangeCursorPosition(a=>{shellInputEditor.getValue()?localStorage.setItem("Websocket Shell/shellInput/a0460de0-60b0-475d-9874-f98c1e2de686/position",[a.position.lineNumber,a.position.column]):localStorage.removeItem("Websocket Shell/shellInput/a0460de0-60b0-475d-9874-f98c1e2de686/position")}),shellInputEditor.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.Enter,()=>{ws&&ws.send(encodeURI(shellInputEditor.getValue()).replace(/%0D/g,""))})}document.querySelector("#shellReturn div.tags span.clear").addEventListener("click",()=>{document.querySelector("#shellReturn .container").innerHTML=""}),document.querySelector("#shellReturn div.tags span.ping").addEventListener("click",()=>{ws&&ws.send("[PING]")}),document.querySelector("#left-box button.toggle-theme").addEventListener("click",()=>{let a=document.querySelector("html");"dark"==a.getAttribute("theme")?(a.removeAttribute("theme"),initShellInputEditor("vs")):(a.setAttribute("theme","dark"),initShellInputEditor("vs-dark"))}),document.querySelector("#left-box button.full-screen").addEventListener("click",()=>{document.fullscreen?document.exitFullscreen():document.querySelector("html").requestFullscreen()}),document.querySelector("#left-box button.run-code").addEventListener("click",()=>{ws&&ws.send(encodeURI(shellInputEditor.getValue()).replace(/%0D/g,""))});</script></html>